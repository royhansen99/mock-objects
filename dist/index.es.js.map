{"version":3,"file":"index.es.js","sources":["../src/index.ts"],"sourcesContent":["import { Path, PathValue, pathSetImmutable } from 'object-standard-path'\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype Entity = { [key: string]: any }\n\nexport type Recipe<T extends EntityClass<Entity>> = (entity: T) => T\n\nclass EntityClass<T extends Entity> {\n  private entity: T\n\n  constructor(entity: T) {\n    this.entity = deepClone(entity)\n  }\n\n  set(changes: Partial<T>) {\n    const clone = deepClone(this.entity)\n\n    for (const key of Object.keys(changes) as (keyof typeof changes)[])\n      clone[key as keyof typeof clone] = changes[\n        key\n      ] as (typeof clone)[keyof typeof clone]\n\n    return new EntityClass(clone)\n  }\n\n  setPath<P extends Path<T, ''>>(path: P, value: PathValue<T, P>) {\n    return new EntityClass(pathSetImmutable(this.entity, path, value))\n  }\n\n  recipe<R extends Partial<T>>(recipeCallback: Recipe<EntityClass<R>>) {\n    return recipeCallback(this) as unknown as EntityClass<T>\n  }\n\n  get() {\n    return deepClone(this.entity)\n  }\n}\n\nexport function entity<T extends Entity>(entity: T) {\n  return new EntityClass<T>(entity)\n}\n\nfunction deepClone<T>(source: T): T {\n  if (source === null || typeof source !== 'object') return source\n\n  const clone: unknown = Array.isArray(source) ? [] : {}\n\n  for (const key in source)\n    if (Object.prototype.hasOwnProperty.call(source, key))\n      (clone as T)[key] = deepClone(source[key])\n\n  return clone as T\n}\n"],"names":["EntityClass","entity","deepClone","changes","clone","key","path","value","pathSetImmutable","recipeCallback","source"],"mappings":";AAOA,MAAMA,EAA8B;AAAA,EAGlC,YAAYC,GAAW;AAChB,SAAA,SAASC,EAAUD,CAAM;AAAA,EAChC;AAAA,EAEA,IAAIE,GAAqB;AACjB,UAAAC,IAAQF,EAAU,KAAK,MAAM;AAExB,eAAAG,KAAO,OAAO,KAAKF,CAAO;AAC7B,MAAAC,EAAAC,CAAyB,IAAIF,EACjCE,CACF;AAEK,WAAA,IAAIL,EAAYI,CAAK;AAAA,EAC9B;AAAA,EAEA,QAA+BE,GAASC,GAAwB;AAC9D,WAAO,IAAIP,EAAYQ,EAAiB,KAAK,QAAQF,GAAMC,CAAK,CAAC;AAAA,EACnE;AAAA,EAEA,OAA6BE,GAAwC;AACnE,WAAOA,EAAe,IAAI;AAAA,EAC5B;AAAA,EAEA,MAAM;AACG,WAAAP,EAAU,KAAK,MAAM;AAAA,EAC9B;AACF;AAEO,SAASD,EAAyBA,GAAW;AAC3C,SAAA,IAAID,EAAeC,CAAM;AAClC;AAEA,SAASC,EAAaQ,GAAc;AAClC,MAAIA,MAAW,QAAQ,OAAOA,KAAW,SAAiB,QAAAA;AAE1D,QAAMN,IAAiB,MAAM,QAAQM,CAAM,IAAI,KAAK;AAEpD,aAAWL,KAAOK;AAChB,IAAI,OAAO,UAAU,eAAe,KAAKA,GAAQL,CAAG,MACjDD,EAAYC,CAAG,IAAIH,EAAUQ,EAAOL,CAAG,CAAC;AAEtC,SAAAD;AACT;"}
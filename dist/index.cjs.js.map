{"version":3,"file":"index.cjs.js","sources":["../src/utils.ts","../src/index.ts"],"sourcesContent":["// Generate a random number between 1-9999, or whatever max-value you specify.\nexport const randomNumber = (max = 9999) => Math.floor(Math.random() * max)\n\n// This function was borrowed from:\n// jlevy / simple-hash.js\n// https://gist.github.com/jlevy/c246006675becc446360a798e2b2d781\n// This is an insecure 32-bit algorithm that will always be 7 chars long.\nexport function hash(str: string) {\n  let hash = 0\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i)\n    hash = (hash << 5) - hash + char\n  }\n  // Convert to 32bit unsigned integer in base 36 and pad with \"0\" to ensure length is 7.\n  return (hash >>> 0).toString(36).padStart(7, '0')\n}\n\n// Will generate a random hash with a length of 35 chars. using the above\n// insecure 32-bit algorithm.\nexport const randomHash = () =>\n  [1, 2, 3, 4, 5].reduce((prev) => prev + hash(Math.random().toString()), '')\n\n// This function was borrowed from:\n// (commented by user: tiagofrancafernandes)\n// https://gist.github.com/hyamamoto/fd435505d29ebfa3d9716fd2be8d42f0?permalink_comment_id=4466912#gistcomment-4466912\n// Will generate a random Uuid v4 string.\nexport const randomUuid = () =>\n  String('xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx').replace(\n    /[xy]/g,\n    (character) => {\n      const random = (Math.random() * 16) | 0\n      const value = character === 'x' ? random : (random & 0x3) | 0x8\n\n      return value.toString(16)\n    }\n  )\n\nexport function deepClone<T>(source: T): T {\n  if (source === null || typeof source !== 'object') return source\n\n  const clone: unknown = Array.isArray(source) ? [] : {}\n\n  for (const key in source)\n    if (Object.prototype.hasOwnProperty.call(source, key))\n      (clone as T)[key] = deepClone(source[key])\n\n  return clone as T\n}\n","import { Path, PathValue, pathSetImmutable } from 'object-standard-path'\nimport { deepClone } from './utils'\nexport { randomNumber, randomHash, randomUuid, hash } from './utils'\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype Entity = { [key: string]: any }\n\nexport type Recipe<T extends EntityClass> = (entity: T) => T\n\nclass EntityClass<T extends Entity = object> {\n  private entity: T\n\n  constructor(entity: T) {\n    this.entity = deepClone(entity)\n  }\n\n  set(changes: Partial<T>) {\n    const clone = deepClone(this.entity)\n\n    for (const key of Object.keys(changes) as (keyof typeof changes)[])\n      clone[key as keyof typeof clone] = changes[\n        key\n      ] as (typeof clone)[keyof typeof clone]\n\n    return new EntityClass(clone)\n  }\n\n  setPath<P extends Path<T, ''>>(path: P, value: PathValue<T, P>) {\n    return new EntityClass(pathSetImmutable(this.entity, path, value))\n  }\n\n  recipe(recipeCallback: Recipe<EntityClass<T>>) {\n    return recipeCallback(this)\n  }\n\n  get() {\n    return deepClone(this.entity)\n  }\n}\n\nexport function entity<T extends Entity>(entity: T) {\n  return new EntityClass<T>(entity)\n}\n"],"names":["randomNumber","max","hash","str","i","char","randomHash","prev","randomUuid","character","random","deepClone","source","clone","key","EntityClass","entity","changes","path","value","pathSetImmutable","recipeCallback"],"mappings":"wHACaA,EAAe,CAACC,EAAM,OAAS,KAAK,MAAM,KAAK,OAAO,EAAIA,CAAG,EAMnE,SAASC,EAAKC,EAAa,CAChC,IAAID,EAAO,EACX,QAASE,EAAI,EAAGA,EAAID,EAAI,OAAQC,IAAK,CAC7B,MAAAC,EAAOF,EAAI,WAAWC,CAAC,EAC7BF,GAAQA,GAAQ,GAAKA,EAAOG,CAC9B,CAEA,OAAQH,IAAS,GAAG,SAAS,EAAE,EAAE,SAAS,EAAG,GAAG,CAClD,CAIa,MAAAI,EAAa,IACxB,CAAC,EAAG,EAAG,EAAG,EAAG,CAAC,EAAE,OAAQC,GAASA,EAAOL,EAAK,KAAK,OAAA,EAAS,SAAS,CAAC,EAAG,EAAE,EAM/DM,EAAa,IACjB,uCAAwC,QAC7C,QACCC,GAAc,CACb,MAAMC,EAAU,KAAK,OAAO,EAAI,GAAM,EAG/B,OAFOD,IAAc,IAAMC,EAAUA,EAAS,EAAO,GAE/C,SAAS,EAAE,CAC1B,CACF,EAEK,SAASC,EAAaC,EAAc,CACzC,GAAIA,IAAW,MAAQ,OAAOA,GAAW,SAAiB,OAAAA,EAE1D,MAAMC,EAAiB,MAAM,QAAQD,CAAM,EAAI,GAAK,GAEpD,UAAWE,KAAOF,EACZ,OAAO,UAAU,eAAe,KAAKA,EAAQE,CAAG,IACjDD,EAAYC,CAAG,EAAIH,EAAUC,EAAOE,CAAG,CAAC,GAEtC,OAAAD,CACT,CCtCA,MAAME,CAAuC,CAG3C,YAAYC,EAAW,CAChB,KAAA,OAASL,EAAUK,CAAM,CAChC,CAEA,IAAIC,EAAqB,CACjB,MAAAJ,EAAQF,EAAU,KAAK,MAAM,EAExB,UAAAG,KAAO,OAAO,KAAKG,CAAO,EAC7BJ,EAAAC,CAAyB,EAAIG,EACjCH,CACF,EAEK,OAAA,IAAIC,EAAYF,CAAK,CAC9B,CAEA,QAA+BK,EAASC,EAAwB,CAC9D,OAAO,IAAIJ,EAAYK,mBAAiB,KAAK,OAAQF,EAAMC,CAAK,CAAC,CACnE,CAEA,OAAOE,EAAwC,CAC7C,OAAOA,EAAe,IAAI,CAC5B,CAEA,KAAM,CACG,OAAAV,EAAU,KAAK,MAAM,CAC9B,CACF,CAEO,SAASK,EAAyBA,EAAW,CAC3C,OAAA,IAAID,EAAeC,CAAM,CAClC"}
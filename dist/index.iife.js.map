{"version":3,"file":"index.iife.js","sources":["../src/index.ts"],"sourcesContent":["import { Path, PathValue, pathSetImmutable } from 'object-standard-path'\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype Entity = { [key: string]: any }\n\nexport type Recipe<T extends EntityClass<Entity>> = (entity: T) => T\n\nclass EntityClass<T extends Entity> {\n  private entity: T\n\n  constructor(entity: T) {\n    this.entity = deepClone(entity)\n  }\n\n  set(changes: Partial<typeof this.entity>) {\n    const clone = deepClone(this.entity)\n\n    for (const key of Object.keys(changes) as (keyof typeof changes)[])\n      clone[key as keyof typeof clone] = changes[\n        key\n      ] as (typeof clone)[keyof typeof clone]\n\n    return new EntityClass(clone)\n  }\n\n  setPath<P extends Path<T, ''>>(path: P, value: PathValue<T, P>) {\n    return new EntityClass(pathSetImmutable(this.entity, path, value))\n  }\n\n  recipe(recipeCallback: Recipe<typeof this>) {\n    return recipeCallback(this)\n  }\n\n  get() {\n    return deepClone(this.entity)\n  }\n}\n\nexport function entity<T extends Entity>(entity: T) {\n  return new EntityClass(entity)\n}\n\nfunction deepClone<T>(source: T): T {\n  if (source === null || typeof source !== 'object') return source\n\n  const clone: unknown = Array.isArray(source) ? [] : {}\n\n  for (const key in source)\n    if (Object.prototype.hasOwnProperty.call(source, key))\n      (clone as T)[key] = deepClone(source[key])\n\n  return clone as T\n}\n"],"names":["EntityClass","entity","deepClone","changes","clone","key","path","value","pathSetImmutable","recipeCallback","source"],"mappings":"2CAOA,MAAMA,CAA8B,CAGlC,YAAYC,EAAW,CAChB,KAAA,OAASC,EAAUD,CAAM,CAChC,CAEA,IAAIE,EAAsC,CAClC,MAAAC,EAAQF,EAAU,KAAK,MAAM,EAExB,UAAAG,KAAO,OAAO,KAAKF,CAAO,EAC7BC,EAAAC,CAAyB,EAAIF,EACjCE,CACF,EAEK,OAAA,IAAIL,EAAYI,CAAK,CAC9B,CAEA,QAA+BE,EAASC,EAAwB,CAC9D,OAAO,IAAIP,EAAYQ,mBAAiB,KAAK,OAAQF,EAAMC,CAAK,CAAC,CACnE,CAEA,OAAOE,EAAqC,CAC1C,OAAOA,EAAe,IAAI,CAC5B,CAEA,KAAM,CACG,OAAAP,EAAU,KAAK,MAAM,CAC9B,CACF,CAEO,SAASD,EAAyBA,EAAW,CAC3C,OAAA,IAAID,EAAYC,CAAM,CAC/B,CAEA,SAASC,EAAaQ,EAAc,CAClC,GAAIA,IAAW,MAAQ,OAAOA,GAAW,SAAiB,OAAAA,EAE1D,MAAMN,EAAiB,MAAM,QAAQM,CAAM,EAAI,GAAK,GAEpD,UAAWL,KAAOK,EACZ,OAAO,UAAU,eAAe,KAAKA,EAAQL,CAAG,IACjDD,EAAYC,CAAG,EAAIH,EAAUQ,EAAOL,CAAG,CAAC,GAEtC,OAAAD,CACT"}